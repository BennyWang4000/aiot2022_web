<meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1.0">
<html lang="zh-TW">

<head>
    <title>世壯運場館資訊站</title>
    <!-- <script type="text/javascript" src="https://cdn.babylonjs.com/babylon.js"></script>
    <script type="text/javascript" src="index.js"></script> -->

    <!-- <script src="../bundle.js"></script> -->
    <!-- <script type="text/javascript" src="{{ url_for('static', filename='index.jsx') }}"></script> -->
    <link rel="stylesheet" href="static/index/index.css">

    <script src="https://cdn.socket.io/4.5.0/socket.io.min.js"
        integrity="sha384-7EyYLQZgWBi67fBtVxw60/OWl1kjsfrPFcaU0pp0nAh+i8FD068QogUvg85Ewy1k"
        crossorigin="anonymous"></script>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>


    <script type="text/javascript" src="babylon.js"></script>


    <script src="https://cdn.babylonjs.com/babylon.js"></script>
    <script src="https://cdn.babylonjs.com/gui/babylon.gui.js"></script>
    <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

</head>

<body style="    padding: 0;    margin: 0;  ">

    <!-- <script async src="https://telegram.org/js/telegram-widget.js?19" data-telegram-discussion="contest/198"
        data-comments-limit="5"></script> -->
    <div id="action_bar"></div>
    <script></script>
    <div id="btn_lst"></div>
    <!-- <script type="text/javascript" src="../static/bundle.js"></script> -->
    <canvas id="babylon_canvas" style="width:100%;height:100%"></canvas>
    <script>
        const canvas = document.getElementById("babylon_canvas");
        const engine = new BABYLON.Engine(canvas, true);

        // var texture_dark
        // var texture_light
        // var texture_round
        // var btn_dark
        // var btn_light
        // var btn_round

        var createScene = function () {
            var scene = new BABYLON.Scene(engine);
            var light = new BABYLON.HemisphericLight("HemiLight", new BABYLON.Vector3(-1, 1, 0), scene);
            light.diffuse = new BABYLON.Color3(1, 1, 1);
            light.specular = new BABYLON.Color3(0, 0, 0.1);
            light.groundColor = new BABYLON.Color3(0.4, 0.4, 0.5);
            var camera = new BABYLON.ArcRotateCamera("Camera", 2, 0, 0, new BABYLON.Vector3(-350, 0, 0), scene);
            camera.setPosition(new BABYLON.Vector3(700, 600, 1200));
            scene.clearColor = new BABYLON.Color4(0, 0, 0, 0.0000000000000001);
            camera.attachControl(canvas, true);
            camera.useAutoRotationBehavior = true;
            camera.maxZ = 50000
            var court = BABYLON.SceneLoader.ImportMesh("",
                "https://raw.githubusercontent.com/BennyWang4000/SWMGglb/main/", "court01.glb", scene, function (newMeshes) {
                    scene.newMeshes.forEach((m) => {
                        m.isPickable = false;
                        m.alphaModel = 1;
                    });
                }
            );


            // var plane_dark = BABYLON.Mesh.CreatePlane("plane_dark", 300, 0, scene);
            // plane_dark.position.y = 400;
            // plane_dark.position.x = -750;
            // plane_dark.position.z = 250;
            // plane_dark.billboardMode = BABYLON.Mesh.BILLBOARDMODE_ALL;
            // texture_dark = BABYLON.GUI.AdvancedDynamicTexture.CreateForMesh(plane_dark);
            // btn_dark = BABYLON.GUI.Button.CreateSimpleButton("but1", "籃球場內\n人數:##.#%\n擁擠程度:普通");
            // btn_dark.width = 1;
            // btn_dark.height = 0.4;
            // btn_dark.color = "white";
            // btn_dark.fontSize = 70;
            // btn_dark.background = "red";
            // btn_dark.onPointerUpObservable.add(function () {
            //     alert("you did it!");
            // });
            // texture_dark.addControl(btn_dark);



            // var plane_light = BABYLON.Mesh.CreatePlane("plane_light", 300, 0, scene);
            // plane_light.position.y = 400;
            // plane_light.position.x = -750;
            // plane_light.position.z = -250;
            // plane_light.billboardMode = BABYLON.Mesh.BILLBOARDMODE_ALL;
            // texture_light = BABYLON.GUI.AdvancedDynamicTexture.CreateForMesh(plane_light);
            // btn_light = BABYLON.GUI.Button.CreateSimpleButton("but2", "籃球場內\n人數:##.#%\n擁擠程度:普通");
            // btn_light.width = 1;
            // btn_light.height = 0.4;
            // btn_light.color = "white";
            // btn_light.fontSize = 70;
            // btn_light.background = "green";
            // btn_light.onPointerUpObservable.add(function () {
            //     alert("you did it!");
            // });
            // texture_light.addControl(btn_light);


            var plane_round = BABYLON.Mesh.CreatePlane("plane_round", 300, 0, scene);
            plane_round.position.y = 400;
            plane_round.billboardMode = BABYLON.Mesh.BILLBOARDMODE_ALL;
            texture_round = BABYLON.GUI.AdvancedDynamicTexture.CreateForMesh(plane_round);
            btn_round = BABYLON.GUI.Button.CreateSimpleButton("but3", "Loading...");
            btn_round.width = 1;
            btn_round.height = 0.4;
            btn_round.color = "white";
            btn_round.fontSize = 70;
            btn_round.background = "green";
            btn_round.onPointerUpObservable.add(function () {
                alert("you did it!");
            });
            texture_round.addControl(btn_round);

            // var plane_loading = BABYLON.Mesh.CreatePlane("plane_loading", 300, 0, scene);
            // plane_loading.position.x = -350;
            // plane_loading.position.y = 400;
            // plane_loading.billboardMode = BABYLON.Mesh.BILLBOARDMODE_ALL;
            // texture_loading = BABYLON.GUI.AdvancedDynamicTexture.CreateForMesh(plane_loading);
            // btn_loading = BABYLON.GUI.Button.CreateSimpleButton("butl", "Loading...");
            // btn_loading.width = 1;
            // btn_loading.height = 0.4;
            // btn_loading.color = "white";
            // btn_loading.fontSize = 70;
            // btn_loading.background = "black";
            // texture_loading.addControl(btn_loading);

            return scene;
        };

        const scene = createScene();
        scene.freezeActiveMeshes();


        engine.runRenderLoop(function () {
            scene.render();

        });
    </script>
    <script type="text/javascript">
        $(document).ready(function () {
            // Socket.IO Start connect
            var socket = io.connect();
            // // Socket.IO send message
            // $("#send").click(function (e) {
            //     // Send message
            //     socket.emit('send', $('#message').val())
            //     // Clear input field
            //     $('#message').val('')
            // });

            // Socket.IO get message
            socket.on('count', function (count) {
                texture_round.removeControl(btn_round)
                btn_round = BABYLON.GUI.Button.CreateSimpleButton("but3", `籃球場內\n人數:${count}\n擁擠程度:普通`);
                btn_round.width = 1;
                btn_round.height = 0.4;
                btn_round.color = "white";
                btn_round.fontSize = 70;
                btn_round.background = "green";
                btn_round.onPointerUpObservable.add(function () {
                    alert("you did it!");
                });
                texture_round.addControl(btn_round);

            });
        });
    </script>
    <div id="content" style="width:100%;height:100%"></div>

    <!-- <script type="text/javascript" src="{{ url_for('static', filename='bundle.js') }}"></script> -->
    <script type="text/javascript" src="../static/bundle.js"></script>
</body>

</html>